<app-page-header [pageHeaderInfo]="pageHeaderInfo"></app-page-header>

<div class="normal-table-wrap">
    <nz-card style="background: #f0f2f5;border: 0; border-radius: 10px;">
        <div nz-row style="display: flex; justify-content: space-around;" class="m-t-30">
            <div nz-col [nzXXl]="11" [nzXl]="11" [nzLg]="11" [nzMd]="11" [nzSm]="24" [nzXs]="24"
                style="background: #fff; border-radius: 16px;padding: 4px;">
                <nz-card nzTitle="FX Receiving Information" class="none-bottom" nzBordered="false">
                    <form nz-form [formGroup]="validateForm">
                        <div nz-row nzJustify="center" nzAlign="middle" class="m-b-10">
                            <nz-form-item nz-col nzXs="24" nzSm="24" nzXl="20" nzXXl="12">
                                <nz-form-label nzRequired nzSpan="24">FX Purchase Amount
                                </nz-form-label>
                                <nz-form-control [nzErrorTip]="amountError">
                                    <div nz-row>
                                        <div nz-col nzSpan="24">
                                            <nz-input-group [nzAddOnAfter]="addOnAfterTemplate">
                                                <input nz-input formControlName="amount" maxlength="10" />
                                            </nz-input-group>
                                        </div>
                                    </div>
                                    <ng-template #amountError let-control>
                                        <ng-container *ngIf="control.hasError('required')">Please input your
                                            FX Purchase Amount</ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-row nzJustify="center" nzAlign="middle" class="m-b-10">
                            <nz-form-item nz-col nzXs="24" nzSm="24" nzXl="20" nzXXl="12">
                                <nz-form-label nzRequired nzSpan="24">FX Receiving Wallet Address
                                </nz-form-label>
                                <nz-form-control [nzErrorTip]="receivingWalletAddressError">
                                    <div nz-row>
                                        <div nz-col nzSpan="24">

                                            <nz-select formControlName="receivingWalletAddress">
                                                <nz-option *ngFor="let item of receivingWalletAddressList;let i=index"
                                                    [nzValue]="item.bankAccountId"
                                                    [nzLabel]="item.chainAccountAddress"></nz-option>
                                            </nz-select>
                                        </div>
                                    </div>
                                    <ng-template #receivingWalletAddressError let-control>
                                        <ng-container *ngIf="control.hasError('required')">Please input your FX
                                            Receiving Wallet Address</ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-row nzJustify="center" nzAlign="middle" class="m-b-10">
                            <nz-form-item nz-col nzXs="24" nzSm="24" nzXl="20" nzXXl="12">
                                <nz-form-label nzRequired nzSpan="24">Receiving Bank Name
                                </nz-form-label>
                                <nz-form-control [nzErrorTip]="receivingBankNameError">
                                    <div nz-row>
                                        <div nz-col nzSpan="24">
                                            <input nz-input formControlName="receivingBankName" maxlength="100" readonly
                                                class="onboard-disabled" />
                                        </div>
                                    </div>
                                    <ng-template #receivingBankNameError let-control>
                                        <ng-container *ngIf="control.hasError('required')">Please input your Receiving
                                            Bank Name</ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                    </form>
                </nz-card>
            </div>
            <div nz-col [nzXXl]="11" [nzXl]="11" [nzLg]="11" [nzMd]="11" [nzSm]="24" [nzXs]="24"
                style="background: #fff; border-radius: 16px;padding: 4px;">
                <nz-card nzTitle="Remitter Information" nzBordered="false" class="none-bottom">
                    <form nz-form [formGroup]="validateForm">
                        <div nz-row nzJustify="center" nzAlign="middle" class="m-b-10">
                            <nz-form-item nz-col nzXs="24" nzSm="24" nzXl="20" nzXXl="12">
                                <nz-form-label nzRequired nzSpan="24">Transaction Wallet Address
                                </nz-form-label>
                                <nz-form-control [nzErrorTip]="transactionWalletAddressError">
                                    <div nz-row>
                                        <div nz-col nzSpan="24">
                                            <nz-select formControlName="transactionWalletAddressId"
                                                (ngModelChange)="onPurchase($event)">
                                                <nz-option *ngFor="let item of fxPurchaseData;let i=index" [nzValue]="i"
                                                    [nzLabel]="item.chainAccountAddress"></nz-option>
                                            </nz-select>
                                        </div>
                                    </div>
                                    <ng-template #transactionWalletAddressError let-control>
                                        <ng-container *ngIf="control.hasError('required')">Please select your
                                            Transaction Wallet Address</ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-row nzJustify="center" nzAlign="middle" class="m-b-10">
                            <nz-form-item nz-col nzXs="24" nzSm="24" nzXl="20" nzXXl="12">
                                <nz-form-label nzRequired nzSpan="24">Transaction Bank Name
                                </nz-form-label>
                                <nz-form-control [nzErrorTip]="transactionBankNameError">
                                    <div nz-row>
                                        <div nz-col nzSpan="24">
                                            <input nz-input formControlName="transactionBankName" readonly
                                                class="onboard-disabled" />
                                        </div>
                                    </div>
                                    <ng-template #transactionBankNameError let-control>
                                        <ng-container *ngIf="control.hasError('required')">Please input your Transaction
                                            Bank Name</ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-row nzJustify="center" nzAlign="middle" class="m-b-10">
                            <nz-form-item nz-col nzXs="24" nzSm="24" nzXl="20" nzXXl="12">
                                <nz-form-label nzRequired nzSpan="24">Available Balance
                                </nz-form-label>
                                <nz-form-control [nzErrorTip]="availableBalanceError">
                                    <div nz-row>
                                        <div nz-col nzSpan="24">
                                            <nz-input-group [nzAddOnAfter]="addOnAfterTemplate1">
                                                <input nz-input formControlName="availableBalance" readonly
                                                    class="onboard-disabled" />
                                            </nz-input-group>
                                        </div>
                                    </div>
                                    <ng-template #availableBalanceError let-control>
                                        <ng-container *ngIf="control.hasError('required')">Please input your Available
                                            Balance</ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                    </form>
                </nz-card>
            </div>
            <ng-container *ngIf="!showStatus">
                <div nz-col nz-col [nzXXl]="23" [nzXl]="23" [nzLg]="23" [nzMd]="23" [nzSm]="24" [nzXs]="24"
                    class="m-t-60" style="background: #fff; border-radius: 16px;padding: 4px;">
                    <div>
                        <nz-card nzTitle="Settlement Information" nzBordered="false" class="none-bottom">
                            <nz-table #rowSelectionTable nzShowSizeChanger [nzData]="dataList" [nzLoading]="nzLoading">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>FX SP</th>
                                        <th>Currency Pair</th>
                                        <th>FX Rate</th>
                                        <th>Commission</th>
                                        <th>Total Payment Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let data of rowSelectionTable.data, index as i">
                                        <!-- <td [nzChecked]="setOfCheckedId.has(i.toString())"
                                        (nzCheckedChange)="onItemChecked(i.toString(), $event)"
                                        style="display: flex; justify-content: center; align-items: center;"> 
                                    </td> -->
                                        <td style="display: flex; justify-content: center; align-items: center;">
                                            <nz-radio-group [(ngModel)]="radioValue" (ngModelChange)="onChecked()">
                                                <label nz-radio [nzValue]="i"></label>
                                            </nz-radio-group>
                                        </td>
                                        <td>{{ data.sp }}</td>
                                        <td>{{ data.currency}}</td>
                                        <td>{{ data.rate }}</td>
                                        <td>{{ data.com + ' ' + purchCurrecy}}
                                        </td>
                                        <td> <b>{{ data.total + ' ' + purchCurrecy}}</b> <span
                                                style="color: blue;font-weight: 600;margin-left: 30px;"
                                                *ngIf="i === 0">{{
                                                ' Recommendation!' }}</span> </td>
                                    </tr>
                                </tbody>
                            </nz-table>
                        </nz-card>
                    </div>
                </div>
            </ng-container>

        </div>
    </nz-card>
    <div nz-row nzJustify="center" nzAlign="middle" class="m-t-25 m-b-10 m-r-60">
        <div nz-col nzSpan="24" style="text-align: end">
            <button nz-button [nzSize]="'large'" nzType="primary" [nzLoading]="isLoading" (click)="onSubmit()">
                Submit
            </button>
        </div>
    </div>
</div>
<ng-template #selectRadioTpl let-key>
    <label nz-radio ngModel></label>
</ng-template>
<ng-template #addOnAfterTemplate>
    <nz-select [ngModel]="0" (ngModelChange)="onReceiving($event)">
        <nz-option *ngFor="let item of fxReceivingData;let i = index" [nzLabel]="item.currecy"
            [nzValue]="i"></nz-option>
    </nz-select>
</ng-template>
<ng-template #addOnAfterTemplate1>
    <nz-select [ngModel]="0" (ngModelChange)="onPurchCurrecy($event)">
        <nz-option *ngFor="let item of purchCurrecyList;let i = index" [nzLabel]="item" [nzValue]="i"></nz-option>
    </nz-select>
</ng-template>

<nz-modal [(nzVisible)]="isVisible" nzTitle="FX Purchasing Confirmation" (nzOnCancel)="cancelView()"
    [nzClosable]="false" [nzWidth]="1000" nzCentered="true">
    <div *nzModalContent>
        <div nz-row style="display: flex; justify-content: space-around; align-items: center;" class="m-t-30">
            <div nz-col [nzXXl]="11" [nzXl]="11" [nzLg]="11" [nzMd]="11" [nzSm]="24" [nzXs]="24">
                <nz-card nzTitle="Remittance Information" class="info-none-bottom">
                    <nz-descriptions nzLayout="vertical" nzTitle="" [nzColumn]="1" [nzColon]="false"
                        [nzBordered]="false" class="card-descriptions-vertical">
                        <nz-descriptions-item nzTitle="Payment Amount">{{ checkedItemComment[0].total +" "+
                            reveingCurrecy
                            }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Transaction Wallet Address">{{
                            validateForm.controls["transactionWalletAddress"].value }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Transaction Bank Name">{{
                            validateForm.controls["transactionBankName"].value
                            }}</nz-descriptions-item>
                    </nz-descriptions>
                </nz-card>
            </div>
            <div nz-col [nzXXl]="1" [nzXl]="1" [nzLg]="1" [nzMd]="1" [nzSm]="0" [nzXs]="0">
                <img src="../../../../assets/imgs//arrow.png" alt="">
            </div>
            <div nz-col [nzXXl]="11" [nzXl]="11" [nzLg]="11" [nzMd]="11" [nzSm]="24" [nzXs]="24">
                <nz-card nzTitle="Receipt of Funds Information" class="info-none-bottom">
                    <nz-descriptions nzLayout="vertical" nzTitle="" [nzColumn]="1" [nzColon]="false"
                        [nzBordered]="false" class="card-descriptions-vertical">
                        <nz-descriptions-item nzTitle="FX Purchase Amount">{{
                            validateForm.controls["availableBalance"].value +" "+
                            purchCurrecy
                            }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="FX Receiving Wallet Address">{{
                            validateForm.controls["receivingWalletAddress"].value}}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Receiving Bank Name">{{
                            validateForm.controls["receivingBankName"].value
                            }}</nz-descriptions-item>
                    </nz-descriptions>
                </nz-card>
            </div>
            <div nz-col [nzXXl]="11" [nzXl]="11" [nzLg]="11" [nzMd]="11" [nzSm]="24" [nzXs]="24">
                <nz-descriptions nzLayout="vertical" [nzColumn]="{ xxl: 2, xl: 2, lg: 2, md: 2, sm: 2, xs: 2 }"
                    [nzColon]="false" [nzBordered]="false" class="card-descriptions-vertical m-t-25">
                    <nz-descriptions-item nzTitle="Settlement Bank">{{ checkedItemComment[0].sp
                        }}</nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Exchange Rate">{{
                        checkedItemComment[0].currency}}</nz-descriptions-item>
                </nz-descriptions>
            </div>
            <div nz-col [nzXXl]="1" [nzXl]="1" [nzLg]="1" [nzMd]="1" [nzSm]="0" [nzXs]="0">
            </div>
            <div nz-col [nzXXl]="11" [nzXl]="11" [nzLg]="11" [nzMd]="11" [nzSm]="24" [nzXs]="24">
                <nz-descriptions nzLayout="vertical" [nzColumn]="{ xxl: 2, xl: 2, lg: 2, md: 2, sm: 2, xs: 2 }"
                    [nzColon]="false" [nzBordered]="false" class="card-descriptions-vertical m-t-25">
                    <nz-descriptions-item nzTitle="Commission">{{ checkedItemComment[0].rate +" "+
                        reveingCurrecy
                        }}</nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Total Payment Amount">{{
                        checkedItemComment[0].total +" "+
                        reveingCurrecy}}</nz-descriptions-item>
                </nz-descriptions>
            </div>
        </div>
    </div>
    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="cancelView()">Cancel</button>
        <button nz-button nzType="primary" (click)="confirmView()" [nzLoading]="isLoading">Confirm</button>
    </div>
</nz-modal>

<nz-modal [(nzVisible)]="isVisibleEnterPassword" nzTitle="Enter Login Password" (nzOnCancel)="cancelEnterPassword()"
    [nzClosable]="false" [nzWidth]="700" nzCentered="true">
    <div *nzModalContent>
        <form nz-form [formGroup]="passwordForm">
            <div nz-row [nzGutter]="24" nzJustify="center" nzAlign="middle">
                <div nz-col nzSpan="20">
                    <nz-form-item class="m-t-15">
                        <nz-form-label nzRequired nzSpan="6" class="text-left">
                            Password
                        </nz-form-label>
                        <nz-form-control [nzErrorTip]="passwordError" nzSpan="18">
                            <input nz-input formControlName="password" />
                            <ng-template #passwordError let-control>
                                <ng-container *ngIf="control.hasError('required')">Please input your
                                    Password</ng-container>
                            </ng-template>
                        </nz-form-control>
                    </nz-form-item>
                </div>
            </div>
        </form>
    </div>
    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="cancelEnterPassword()">Cancel</button>
        <button nz-button nzType="primary" (click)="confirmEnterPassword()" [nzLoading]="isLoading"
            [disabled]="!this.passwordForm.valid">Confirm</button>
    </div>
</nz-modal>