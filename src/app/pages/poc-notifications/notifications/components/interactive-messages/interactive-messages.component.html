<!--
 * @Author: chenyuting
 * @Date: 2024-12-23 14:21:04
 * @LastEditors: chenyuting
 * @LastEditTime: 2024-12-25 17:55:22
 * @Description: 
-->
<div nz-row class="m-t-10" nzJustify="center" nzAlign="middle" nzGutter="24">
  <div nz-col [nzSpan]="24">
    <div nz-row nzJustify="space-between" nzGutter="24" class="m-b-10">
      <div nz-col>
        <button
          nz-button
          [nzSize]="'large'"
          nzType="primary"
          style="border-radius: 12px"
          (click)="toCompose()"
        >
          <img
            class="m-r-10"
            src="../../../../../../assets/imgs/notification-send.svg"
            alt=""
          />
          {{ 'Compose' }}
        </button>
      </div>
      <div nz-col>
        <nz-select (ngModelChange)="getDataList($event)" ngModel="" class="m-l-15 select-notice" nzSize="large">
          <nz-option nzValue="" nzLabel="All"></nz-option>
          <nz-option [nzValue]="1" nzLabel="Sent"></nz-option>
          <nz-option [nzValue]="2" nzLabel="Received"></nz-option>
        </nz-select>
      </div>
    </div>
    <div *ngFor="let item of dataList; index as i">
      <nz-card
        nzBordered="false"
        nzTitle=""
        class="m-r-8 m-b-20"
        [style.background]="item.sendType === 1 ? '#EEFAEE': '#EEF4FA'"
        style="border-radius: 12px"
      >
        <div nz-row nzJustify="space-between" nzAlign="middle" nzGutter="24">
          <div nz-col>
            <div nz-row nzJustify="space-between" nzAlign="middle">
              <!-- <div nz-col class="notice-card">
                  <img nz-col class="m-l-10 m-r-10" src="" alt="" />
                </div> -->
              <span>{{ item.fromBankName }}</span>
              <img
                nz-col
                class="m-l-10 m-r-10"
                src="../../../../../../assets/imgs/notification-arrow.svg"
                alt=""
              />
              <!-- <div nz-col class="notice-card">
                  <img nz-col class="m-l-10 m-r-10" src="" alt="" />
                </div> -->
              <span>{{ item.toBankName }}</span>
            </div>
          </div>
          <div nz-col>
            <span style="color: #60a3ce">{{ 'Send by ' + item.fromName }}</span>
          </div>
        </div>
        <div class="m-t-20 m-b-20">
          <p nz-typography>
            <span *ngIf="item.readState === 0"
              ><b>{{ item.title }}</b></span
            >
            <span *ngIf="item.readState === 1">{{ item.title }}</span>
          </p>
        </div>
        <nz-divider></nz-divider>
    
        <div
          nz-row
          nzJustify="space-between"
          nzAlign="middle"
          nzGutter="24"
          class="m-b-10"
        >
          <div nz-col>
            <span style="color: #60a3ce">{{
              item.sendTime | map: 'timeStamp'
            }}</span>
          </div>
          <div nz-col>
            <nz-space>
              <button *nzSpaceItem nz-button [nzSize]="'large'" nzType="text">
                <img
                  class="m-r-10"
                  style="width: 20px; height: 20px"
                  src="../../../../../../assets/imgs/notification-view.svg"
                  alt=""
                />
                View >></button
              ><button *nzSpaceItem nz-button [nzSize]="'large'" nzType="text">
                <img
                  class="m-r-10"
                  style="width: 20px; height: 20px"
                  src="../../../../../../assets/imgs/notification-reply.svg"
                  alt=""
                />
                Reply
              </button></nz-space
            >
          </div>
        </div>
      </nz-card>
    </div>
  </div>
</div>
<nz-modal
  [(nzVisible)]="isVisibleSend"
  nzTitle="Compose"
  (nzOnCancel)="cancelSend()"
  [nzClosable]="false"
  [nzWidth]="800"
  nzCentered="true"
  [nzFooter]="null"
>
  <div *nzModalContent>
    <form nz-form [formGroup]="sendForm" nzLayout="vertical">
      <div nz-row [nzGutter]="24" nzJustify="center" nzAlign="middle">
        <div nz-col nzSpan="20">
          <nz-form-item>
            <nz-form-label nzRequired nzSpan="24" class="text-left">
              Recipient
            </nz-form-label>
            <div nz-row [nzGutter]="24" nzJustify="space-between" nzAlign="middle">
                <nz-form-control
                  [nzErrorTip]="recipientError"
                  nzSpan="12"
                  class="m-b-20"
                >
                  <nz-select
                    nzPlaceHolder=""
                    formControlName="toClientType"
                    (ngModelChange)="onSelectBank($event)"
                  >
                    <nz-option [nzValue]="1" nzLabel="Custodian Bank"></nz-option>
                    <nz-option [nzValue]="2" nzLabel="Commercial Bank"></nz-option>
                  </nz-select>
                  <ng-template #recipientError let-control>
                    <ng-container *ngIf="control.hasError('required')"
                      >Please input your Recipient</ng-container
                    >
                  </ng-template>
              </nz-form-control>
              <nz-form-control
                nzSpan="12"
                class="m-b-20"
              >
                <nz-select
                  nzPlaceHolder=""
                  formControlName="toClientCode"
                >
                  <nz-option
                    *ngFor="let item of bankNameList; index as i"
                    [nzValue]="item.bankIdentifierCode"
                    [nzLabel]="item.bankName"
                  >
                  </nz-option>
                </nz-select>
              </nz-form-control>
            </div>
           
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzRequired nzSpan="24" class="text-left">
              Subject
            </nz-form-label>
            <nz-form-control
              [nzErrorTip]="subjectError"
              nzSpan="24"
              class="m-b-20"
            >
              <input
                nz-input
                formControlName="title"
              />
              <ng-template #subjectError let-control>
                <ng-container *ngIf="control.hasError('required')"
                  >Please input your Subject</ng-container
                >
              </ng-template>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="24" class="text-left">
              Content
            </nz-form-label>
            <nz-form-control
              nzSpan="24"
              class="m-b-20"
            >
            <div nz-row>
              <div nz-col nzSpan="24" >
                <quill-editor style="height:150px; max-height: 150px;" placeholder="" [modules]="modules" formControlName="content"/>
              </div>
            </div>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-control nzSpan="24">  
              <div style="text-align: end;">
                <nz-space>
                  <button 
                    nz-button 
                    *nzSpaceItem 
                    nzType="text" 
                    class="operate-text"
                    (click)="cancelSend()"
                  > 
                    Cancel
                  </button>
                  <button
                    nz-button
                    nzType="primary"
                    *nzSpaceItem
                    (click)="send()"
                    [nzLoading]="isLoading"
                    [disabled]="!this.sendForm.valid"
                  >
                    Send
                  </button>
                </nz-space>
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </form>
  </div>
</nz-modal>
